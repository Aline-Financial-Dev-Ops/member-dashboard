<ng-template #sendOtp>
  <p class="text-muted fw-light mb-3"><fa-icon icon="info-circle"></fa-icon> Please enter your username and select a contact method so we can <span class="fw-bold">send you a reset code.</span></p>
  <form [formGroup]="createOtpForm" (ngSubmit)="sendOtpCode()">
    <div class="row row-cols-1">
      <div class="col my-2">
        <div class="form-floating">
          <input type="text"
                 id="username"
                 formControlName="username"
                 placeholder="Username"
                 class="form-control"/>
          <label for="username" class="form-label">Username</label>
        </div>
        <div *ngIf="createOtpForm.get('username')?.invalid && createOtpForm.get('username')?.touched" class="text-danger">
          Username is invalid.
        </div>
      </div>
    </div>
    <div class="row row-cols-2">
      <div class="col my-2">
          <input type="radio"
                 id="phone"
                 value="phone"
                 formControlName="contactMethod"
                 class="form-check-inline"/>
          <label for="phone" class="form-check-label">Phone</label>
      </div>
      <div class="col my-2">
        <input type="radio"
               id="email"
               value="email"
               formControlName="contactMethod"
               class="form-check-inline"/>
        <label for="email" class="form-check-label">Email</label>
      </div>
    </div>
    <div class="d-flex justify-content-center mt-5">
      <button [disabled]="sendingOtp || createOtpForm.invalid" type="submit" class="btn btn-primary btn-lg">Send Code
        <span *ngIf="sendingOtp" class="d-inline-flex justify-content-center align-items-center">
          <span class="spinner-grow spinner-grow-sm"></span>
        </span>
      </button>
    </div>
  </form>
</ng-template>

<ng-template #verification>
  <p>Enter your <span class="fw-bold">one-time passcode</span>.</p>

  <div class="my-2">
    <div appSingleChar [inputLength]="6" (valueChange)="updateOtp($event)"></div>
  </div>

  <p *ngIf="verificationError" class="mt-3 text-danger">{{verificationError}}</p>

  <div class="d-flex justify-content-center mt-5">
    <button [disabled]="verifyingOtp || otpIncorrectLength()" class="btn btn-primary btn-lg" (click)="verifyOtp()">Verify
      <span *ngIf="verifyingOtp" class="d-inline-flex justify-content-center align-items-center">
          <span class="spinner-grow spinner-grow-sm"></span>
        </span>
    </button>
  </div>

</ng-template>

<ng-template #resetPassword>

  <form [formGroup]="resetPasswordForm">
    <div class="form-floating w-100 position-relative my-2">
      <input type="text"
             class="form-control"
             formControlName="newPassword"
             placeholder="New Password"
             id="newPassword"/>
      <label for="newPassword" class="form-label">New Password</label>
      <app-form-control-validation-indicator
        defaultMessage="Enter your new password."
        errorMessage="Password must be at least 8 characters and include at least one uppercase letter, one lowercase letter, one number, and one symbol."
        [validateControl]="resetPasswordForm.get('newPassword')">
      </app-form-control-validation-indicator>
    </div>
    <div class="form-floating w-100 position-relative my-2">
      <input type="text"
             class="form-control"
             formControlName="confirmNewPassword"
             placeholder="Confirm Password"
             id="confirmNewPassword"/>
      <label for="confirmNewPassword" class="form-label">Confirm Password</label>
      <app-form-control-validation-indicator
        defaultMessage="Re-enter your new password."
        errorMessage="Passwords you entered do not match."
        [validateControl]="resetPasswordForm.get('confirmNewPassword')">
      </app-form-control-validation-indicator>
    </div>
  </form>

</ng-template>

<ng-container #formContainer>

</ng-container>
